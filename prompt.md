# 任务目标
迁移 C 盘下的 Program Files 和 User/{账号名}/AppData 文件夹下的超过 1G 的大文件夹到目标路径，并在 C 盘原路径下建立软链，从而达到释放 C 盘磁盘空间的目的。

# 手动任务流程
以下是手动执行上述操作流程：
1. 打开 TreeSize Free 扫描 C 盘下的磁盘空间占用；
2. 肉眼查看磁盘 User/{账号名}/AppData、Program Files 文件夹下，占用超过 1G 的大文件；
3. 手动进入 C 盘，依次压缩大文件夹；
4. 手动剪切压缩文件到目标磁盘路径，解压；
5. 手动删除 C 盘原路径下的文件夹；
6. 如果文件夹删除失败，手动打开任务管理器，结束相关程序的线程任务，重新删除。
7. 手动用管理员权限打开 cmd 命令输入框，输入如下命令创建软链接
```
mklink /D "C:\Program Files\Docker" "D:\C_backup\Program Files\Docker"
```
8. 检查链接是否生效，在命令行输入如下命令：
```
dir "C:\Program Files\Docker"
```
如果显示 <SYMLINKD>，并指向 D:\C_backup\Program Files\Docker，说明链接创建成功。

# 自动任务任务流程

1. 需要将手动任务流程自动化，使用 Python 脚本实现。
2. 脚本需要实现以下场景功能：
    1-仅扫描指定目录（比如：User/{账号名}/AppData、Program Files）下超过 1G 的文件夹，输出扫描结果文件；
      - 支持设置扫描层级深度，不同路径可以设置不同的扫描深度
      - 支持设置排除的文件夹名称列表，全局排除和特定路径排除
      - 支持扫描大文件和大文件夹
    2-基于扫描结果文件夹，识别文件夹并压缩，剪切压缩文件到目标磁盘路径，解压，输出 C 盘路径与迁移路径的 JSON 映射文件；
      - 迁移时保持相对路径结构
      - 支持资源使用限制，控制CPU和内存使用率
      - 显示详细的迁移进度和状态
    3-基于步骤 2 生成的 JSON 映射文件，删除 C 盘原路径下的文件夹，如果程序出现占用，则自动识别占用程序，并尝试结束，如果操作失败，则记录错误，结束程序的执行；
      - 支持多次重试机制
      - 区分文件和文件夹的删除处理
    4-进入 windows 管理员权限，创建软链接并检查软链是否生效；
      - 区分文件和文件夹的软链接创建
      - 验证软链接是否创建成功
    5-自动执行 1~4 步骤。
3. 配置项要求
    - 扫描目录的路径列表，每个路径可单独设置扫描深度和排除文件夹
    - 文件大小阈值（目前固定 1G）
    - 目标磁盘路径
    - 日志文件路径
    - 重试次数和重试间隔时间
    - 压缩文件的临时存储路径
    - 资源使用限制（CPU和内存使用率）
    - 其他可能涉及的配置项……
4. 性能要求
    - 根据运行脚本主机的 windows 的 CPU 和内存配置，合理分配并行处理的线程，确保脚本能够在合理的时间内完成任务。
    - 需要显示进度条或进度信息；
    - 对大文件处理时的内存使用进行优化
    - 支持资源监控，限制CPU和内存使用率，避免系统资源占用过高
5. 输出一个图形界面，图形界面左边操作按钮，右边显示日志信息、输出的结果信息。
    - 支持选择扫描、迁移、清理、链接等单独操作或一键执行全部流程
    - 实时显示操作进度和日志信息
    - 支持查看扫描结果和映射文件

# 注意事项
1. 任务需要在管理员权限下执行；
2. 任务需要在 Windows 系统上执行；
3. 脚本内容需要加入详细的中文注释信息，以方便日后维护；
4. 脚本要输出详细的过程打印日志信息，包括日志文件和控制台日志。
5. 脚本所有预设值都需要在 yaml 配置文件中可配置化。
6. 需要生成一个 require 依赖管理文件。
7. 脚本需要实现自动重试机制。